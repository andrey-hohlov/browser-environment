!function(i,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(i=i||self).browserEnvironment=e()}(this,function(){"use strict";function n(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}var e,t=!1;return new(function(){function i(){!function(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.browser=!1,this.opera=!1,this.firefox=!1,this.safari=!1,this.ie=!1,this.ie10=!1,this.ie11=!1,this.edge=!1,this.chrome=!1,this.iPhone=!1,this.iPad=!1,this.iPod=!1,this.android=!1,this.mac=!1,this.win=!1,this.ios=!1,this.userTouching=!1,this.userHovering=!1,this.utilityFocus=!1,this.pointerFocus=!1,this.viewport=null,this.retina=!1,this.touchScreen=!1,this.$listeners=[],this.init()}return function(i,e,t){e&&n(i.prototype,e),t&&n(i,t)}(i,[{key:"init",value:function(){var e=this;"undefined"!=typeof window&&(this.browser=!0,this.utilityFocus=!0,["onMouseOver","onTouchStart","onDocumentFocusIn","onDocumentKeydown","onDocumentClick","onWindowBlur","detectViewport"].forEach(function(i){e[i]=e[i].bind(e)}),this.throttledOnResize=function(o,s){var h=null;return function(){for(var i=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];h=h||(h||setTimeout(function(){o.apply(i,t),h=null},s))}}(this.detectViewport,200),this.detect(),this.setClasses(),this.setEventListeners())}},{key:"destroy",value:function(){this.opera=!1,this.firefox=!1,this.safari=!1,this.ie=!1,this.ie10=!1,this.ie11=!1,this.edge=!1,this.chrome=!1,this.iPhone=!1,this.iPad=!1,this.iPod=!1,this.android=!1,this.mac=!1,this.win=!1,this.ios=!1,this.userTouching=!1,this.userHovering=!1,this.utilityFocus=!1,this.pointerFocus=!1,this.viewport=null,this.retina=!1,this.touchScreen=!1,this.setClasses(),this.setEventListeners(!1)}},{key:"setEventListeners",value:function(i){var e=!(0<arguments.length&&void 0!==i)||i?"addEventListener":"removeEventListener";window[e]("mouseover",this.onMouseOver),window[e]("touchstart",this.onTouchStart),window[e]("resize",this.throttledOnResize),window[e]("blur",this.onWindowBlur),document.documentElement[e]("focusin",this.onDocumentFocusIn),document.documentElement[e]("keydown",this.onDocumentKeydown),document.documentElement[e]("pointerdown",this.onDocumentClick),document.documentElement[e]("pointerup",this.onDocumentClick),document.documentElement[e]("mousedown",this.onDocumentClick),document.documentElement[e]("mouseup",this.onDocumentClick),document.documentElement[e]("click",this.onDocumentClick)}},{key:"detect",value:function(){var i=window.navigator,e=i.userAgent,t=i.platform;this.iPhone=-1!==e.indexOf("iPhone"),this.iPad=-1!==e.indexOf("iPad"),this.iPod=-1!==e.indexOf("iPod"),this.android=/Android/.test(e),this.mac=!(this.iPhone||this.iPad||this.iPod||this.android||-1===t.indexOf("Mac")),this.win=-1!==t.indexOf("Win"),this.ios=this.iPhone||this.iPad||this.iPod,this.opera=!!window.opr&&!!window.opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),this.firefox="undefined"!=typeof InstallTrigger,this.safari=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||window.safari.pushNotification).toString(),this.ie=!!document.documentMode,this.ie10=10===document.documentMode,this.ie11=11===document.documentMode,this.edge=!this.ie&&!!window.StyleMedia,this.chrome=!!window.chrome&&!!window.chrome.webstore,this.retina=1<window.devicePixelRatio,this.touchScreen=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),this.detectViewport()}},{key:"detectViewport",value:function(){this.viewport={w:Math.max(document.documentElement.clientWidth,window.innerWidth||0),h:Math.max(document.documentElement.clientHeight,window.innerHeight||0)},this.emit()}},{key:"setClasses",value:function(){var e={_mac:this.mac,_win:this.win,_ios:this.ios,_android:this.android,_ipad:this.iPad,_iphone:this.iPhone,_opera:this.opera,_firefox:this.firefox,_safari:this.safari,_ie:this.ie,_ie10:this.ie10,_ie11:this.ie11,_edge:this.edge,_chrome:this.chrome,_retina:this.retina,_touchscreen:this.touchScreen,_usertouching:this.userTouching,_userhovering:this.userHovering,_utilityfocus:this.utilityFocus,_pointerfocus:this.pointerFocus};Object.keys(e).forEach(function(i){e[i]?document.documentElement.classList.add(i):document.documentElement.classList.remove(i)})}},{key:"onMouseOver",value:function(){this.userHovering||(this.userTouching=!1,this.userHovering=!0,this.setClasses(),this.emit())}},{key:"onTouchStart",value:function(){this.userTouching||(this.userHovering=!1,this.userTouching=!0,this.setClasses(),this.emit())}},{key:"onDocumentFocusIn",value:function(i){this.pointerFocus&&(this.ie10||this.ie11)&&(!i.originalEvent||i.originalEvent.fromElement||i.originalEvent.relatedTarget||(t=!0,setTimeout(function(){t=!1}))),this.pointerFocus=t,this.utilityFocus=!this.pointerFocus,this.setClasses()}},{key:"onDocumentKeydown",value:function(){clearTimeout(e),t=!1}},{key:"onDocumentClick",value:function(){t=!0,clearTimeout(e),e=setTimeout(function(){t=!1},600)}},{key:"onWindowBlur",value:function(){var e=this;window.addEventListener("focus",function i(){e.pointerFocus&&(t=!0,setTimeout(function(){t=!1})),window.removeEventListener("focus",i)})}},{key:"getEnv",value:function(){return{opera:this.opera,firefox:this.firefox,safari:this.safari,ie:this.ie,edge:this.edge,chrome:this.chrome,iPhone:this.iPhone,iPad:this.iPad,iPod:this.iPod,android:this.android,mac:this.mac,win:this.win,ios:this.ios,retina:this.retina,touchScreen:this.touchScreen,userTouching:this.userTouching,userHovering:this.userHovering,viewport:this.viewport}}},{key:"emit",value:function(){var e=this.getEnv();this.$listeners.forEach(function(i){return i(e)})}},{key:"subscribe",value:function(i){var e=this;if("function"!=typeof i)throw new TypeError("Handler must be function");return this.$listeners.includes(i)||this.$listeners.push(i),function(){return e.unsubscribe(i)}}},{key:"unsubscribe",value:function(i){var e=this.$listeners.indexOf(i);-1<e&&this.$listeners.splice(e,1)}}]),i}())});
